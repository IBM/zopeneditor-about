<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reviewing your code using COBOL Metrics | Z Open Editor for COBOL and PL/I</title>
    <meta name="description" content="Language support for COBOL and PL/I in VS Code">
    
    
    <link rel="preload" href="/Zowe-Commercial/wazi-about/assets/css/0.styles.e9d11b92.css" as="style"><link rel="preload" href="/Zowe-Commercial/wazi-about/assets/js/app.8b8c809f.js" as="script"><link rel="preload" href="/Zowe-Commercial/wazi-about/assets/js/2.7debf6d8.js" as="script"><link rel="preload" href="/Zowe-Commercial/wazi-about/assets/js/7.93f466ca.js" as="script"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/10.85495757.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/11.f0ffac04.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/12.92c83043.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/13.32887d30.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/14.4b70b252.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/15.c398c176.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/16.703b54d8.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/17.c1a2e87b.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/18.7d9bb7b8.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/19.65a391fe.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/20.876df235.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/21.0d62e929.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/22.a00770f4.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/23.516d888f.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/24.14997470.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/25.da53f94f.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/3.38aec3d5.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/4.63da4a54.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/5.0dfa0bda.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/6.2bd5dc84.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/8.b7301c57.js"><link rel="prefetch" href="/Zowe-Commercial/wazi-about/assets/js/9.af97da6d.js">
    <link rel="stylesheet" href="/Zowe-Commercial/wazi-about/assets/css/0.styles.e9d11b92.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Zowe-Commercial/wazi-about/" class="home-link router-link-active"><!----> <span class="site-name">Z Open Editor for COBOL and PL/I</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Zowe-Commercial/wazi-about/Docs/introduction.html" class="nav-link">Documentation</a></div> <a href="https://github.com/IBM/wazi-about/issues" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Zowe-Commercial/wazi-about/Docs/introduction.html" class="nav-link">Documentation</a></div> <a href="https://github.com/IBM/wazi-about/issues" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Zowe-Commercial/wazi-about/Docs/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/getting_started.html" class="sidebar-link">Getting Started</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/userinterface.html" class="sidebar-link">Exploring the user interface</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/samplefiles.html" class="sidebar-link">Exploring the sample files</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/knownissues.html" class="sidebar-link">Known issues and limitations</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Configuration Options</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Zowe-Commercial/wazi-about/Docs/setting_toc.html" class="sidebar-link">Setting preferences</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/setting_preferences.html" class="sidebar-link">Setting workspace preferences and user preferences</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/setting_propertygroup.html" class="sidebar-link">Setting property groups</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/setting_fileassociations.html" class="sidebar-link">Setting file associations</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Editing COBOL and PL/I</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Zowe-Commercial/wazi-about/Docs/editor_codechanges.html" class="sidebar-link">Making code changes</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/editor_metrics.html" class="active sidebar-link">Reviewing your code using COBOL Metrics</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Using other VS Code Capabilities</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Zowe-Commercial/wazi-about/Docs/git_createbranches.html" class="sidebar-link">Creating Git branches</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/git_commitchanges.html" class="sidebar-link">Committing changes into Git branches</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/editor_search.html" class="sidebar-link">Searching for COBOL and PL/I components</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Interacting with z/OS using Zowe</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Zowe-Commercial/wazi-about/Docs/zowe_interactwithzos.html" class="sidebar-link">Interacting with z/OS®</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/zowe_datasets.html" class="sidebar-link">Manipulating data sets</a></li><li><a href="/Zowe-Commercial/wazi-about/Docs/zowe_submitjcl.html" class="sidebar-link">Submitting JCL to compile, link, and run jobs</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="reviewing-your-code-using-cobol-metrics"><a href="#reviewing-your-code-using-cobol-metrics" aria-hidden="true" class="header-anchor">#</a> Reviewing your code using COBOL Metrics</h1> <p>The Z Open Editor's COBOL language server provides you with all the editing capabilities discussed in the previous section and can also utilize its knowledge about COBOL to provide you with statistical counters for COBOL language elements such as Operators and Operands, as well as use those to compute various complexity metrics, such as <a href="https://en.wikipedia.org/wiki/Halstead_complexity_measures" target="_blank" rel="noopener noreferrer">Halstead metrics<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (also see <a href="https://www.verifysoft.com/en_halstead_metrics.html" target="_blank" rel="noopener noreferrer">[1]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.geeksforgeeks.org/software-engineering-halsteads-software-metrics/" target="_blank" rel="noopener noreferrer">[2]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.tutorialspoint.com/software_engineering/software_design_complexity.htm" target="_blank" rel="noopener noreferrer">[3]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). You can use these metrics to assess the complexity of your COBOL programs as well as set thresholds for various quality metrics that you do not want violate.</p> <p>When you open a COBOL program file (for example, <code>COBOL/SAM1.cbl</code>) and click inside the editor, you will see some metrics-related annotations for that file in the editor's status bar at the bottom.</p> <p>To view all of the file's COBOL program metrics, click on the <code>View All Metrics</code> link in the status bar. This will open the metrics view on the right side of the editor. You can also open this view by right-clicking inside your open COBOL program and selecting <code>Program Metrics</code> from the context menu. The metrics view shows a table of available metrics that you can scroll through to review. To learn about each metric, click the <code>(i)</code> icon to access a tooltip.</p> <p>The table is interactive, reacting to your edits as values get recomputed every time you save and showing you change deltas. For example:</p> <ul><li>In <code>SAM1.cbl</code>, go to Line 243 and cut out the entire <code>IF</code> block until Line 270 and save.</li> <li>Check the table again as the <code>Your Change</code> column was updated, showing relative changes for each metric that was impacted. For example, as nested <code>IF-ELSE</code> statements were removed, the <code>Cyclomatic Complexity</code> of the program went down by 5. You can see how many other metrics were also updated. The Z Open Editor presents these changes relative to the time you opened the editor. If you close and reopen it the numbers will be reset.</li> <li>As the code that branches out to other paragraphs was cut out, you can see red squiggles and errors in the Problems view telling you about <code>Unreachable Code</code> as no other code calls these paragraphs now.</li> <li>Go back into the editor and press <code>Ctrl+Z</code> (Windows) or <code>Cmd+Z</code> (Mac) to restore the code you cut out to get back to a consistent state.</li></ul> <p>You can also set thresholds for your metrics either in your personal User Preferences or in Workspace Preferences if you want to share these with your team. Follow these steps to set thresholds for your metrics:</p> <ol><li>Open the settings for the Z Open Editor for COBOL and PL/I as described in the <a href="/Zowe-Commercial/wazi-about/Docs/setting_toc.html">Settings preferences</a>.</li> <li>Press <code>Ctrl+Space</code> (Windows and Mac) and select <code>&quot;zopeneditor.cobol.metrics&quot;</code> and press <code>Enter</code>.</li> <li>This adds an empty <code>&quot;zopeneditor.cobol.metrics&quot;: [],</code> entry to your settings on the right.</li> <li>Put the cursor inside the array's square brackets, type <code>{}</code>, place the cursor inside the braces, and press <code>Ctrl+Space</code>.</li> <li>The code completion drop down is opened and you can select the <code>&quot;metric&quot;</code> property.</li> <li>Select <code>&quot;cyclomatic-complexity&quot;</code> from the metrics available for threshold that are proposed.</li> <li>Type a comma and press <code>Enter</code>. Then, press <code>Ctrl+Space</code> again to select <code>&quot;direction&quot;: &quot;larger&quot;,</code> and once more to select <code>&quot;value&quot;:</code>. Set the <code>value</code> to 15.</li> <li>You can now use code completion to quickly provide complex preference data objects.</li> <li>Complete the preferences entry to look like this and save:</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;zopeneditor.cobol.metrics&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;comments-percentage&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;smaller&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;comments-percentage&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;larger&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">60</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cyclomatic-complexity&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;larger&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>If you go back to the <code>SAM1.cbl</code> editor and review the metrics table, you can now see:</p> <ul><li>Another column in the table called <code>Threshold</code> that contains the values you just entered.</li> <li>Messages about threshold violations are displayed on the far right of the table. For example, for <code>SAM1</code>, the Cyclomatic complexity is 29 and therefore larger than the threshold. The comments percentage is smaller than 15% and therefore also shown as a violation.</li> <li>If you open the <code>SAM2.cbl</code> program, both metrics are in the acceptable range.</li></ul> <p><strong>Next step</strong>: <a href="/Zowe-Commercial/wazi-about/Docs/git_commitchanges.html">Committing changes into Git branches</a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/1/2019, 12:25:53 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Zowe-Commercial/wazi-about/Docs/editor_codechanges.html" class="prev">
          Making code changes
        </a></span> <span class="next"><a href="/Zowe-Commercial/wazi-about/Docs/git_createbranches.html">
          Creating Git branches
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Zowe-Commercial/wazi-about/assets/js/app.8b8c809f.js" defer></script><script src="/Zowe-Commercial/wazi-about/assets/js/2.7debf6d8.js" defer></script><script src="/Zowe-Commercial/wazi-about/assets/js/7.93f466ca.js" defer></script>
  </body>
</html>
