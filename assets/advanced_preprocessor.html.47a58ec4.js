import{r as i,o as p,a as l,b as e,d as o,w as a,F as c,c as r,e as t}from"./app.dfb34f82.js";import{_ as d}from"./plugin-vue_export-helper.21dcd24c.js";const h={},u=r('<h1 id="preprocessor-support" tabindex="-1"><a class="header-anchor" href="#preprocessor-support" aria-hidden="true">#</a> Preprocessor support</h1><p>Z Open Editor provides the advanced capability to integrate parsing of COBOL and PL/I programs with a custom preprocessor to allow editing programs that contain such preprocessor statements without causing the editor to show syntax errors. The preprocessor would be executed on either a developer machine by Z Open Editor in the background (local) or a z/OS system (remote), taking COBOL or PL/I with custom code and transforming it to a valid program. Users can then continue editing such programs by using the preprocessor input to still receive full language support such as code completion, syntax error highlighting, and outline view for the regular COBOL or PL/I statements. Then at each save or editor focus change the preprocessor can run automatically again to update the processed representation used by the editor. The editor would not learn the preprocessor language, but rather ensure that the resulting preprocessed output is still valid COBOL or PL/I.</p><h2 id="local-preprocessor" tabindex="-1"><a class="header-anchor" href="#local-preprocessor" aria-hidden="true">#</a> Local preprocessor</h2><h3 id="example-workflow" tabindex="-1"><a class="header-anchor" href="#example-workflow" aria-hidden="true">#</a> Example workflow</h3><p>The following workflow is written from the perspective of developer, Deb.</p><ol><li>Deb installs a command-line centric preprocessor program on her local development machine.</li><li>Deb creates a <code>zapp.yaml</code> file with a preprocessor profile type. The profile specifies the command-line for running the preprocessor on the currently edited program file as well as the output path for the preprocessed program files.</li><li>Deb edits a program file with preprocessor statements in Z Open Editor.</li><li>Deb either manually starts preprocessing the program via a right-click menu command or creates a user setting to automatically run the preprocessor on Save.</li><li>Z Open Editor starts the preprocessor command in the background and sends the output file to its COBOL (PL/I) parser.</li><li>Z Open Editor&#39;s COBOL (PL/I) parser will compare the program in the editor with the output of the preprocessor command.</li><li>Deb hovers over processor statements in Z Open Editor, which displays the resulting COBOL (PL/I).</li><li>Deb continues editing the program in Z Open Editor. Z Open Editor continues to provide full language support for all the parts of the program that are not preprocessor statements.</li></ol>',6),m=t("To learn and explore this workflow, check out the example preprocessor and code samples in our Github repository at "),g={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor",target:"_blank",rel:"noopener noreferrer"},b=t("https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor"),f=t(". Review the "),_={href:"https://github.com/IBM/zopeneditor-sample/blob/wazi-main/preprocessor/README.md#local-preprocessor-examples",target:"_blank",rel:"noopener noreferrer"},k=t("Readme"),w=t(" file in this folder with detailed instructions for building and running the sample."),y=e("h3",{id:"requirements-for-the-preprocessor",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#requirements-for-the-preprocessor","aria-hidden":"true"},"#"),t(" Requirements for the preprocessor")],-1),v=e("p",null,"To be able to integrate your preprocessor with Z Open Editor, it must fulfill these requirements:",-1),O=e("ul",null,[e("li",null,"It needs to run locally on your development machine where Z Open Editor is running."),e("li",null,"You need to be able to run the processor via command-line."),e("li",null,"The command-line operation needs to create an output file that contains valid COBOL."),e("li",null,"The output path can be computed by specifying a new file extension to be used with the program file name.")],-1),x=e("h3",{id:"zapp-profile",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#zapp-profile","aria-hidden":"true"},"#"),t(" ZAPP profile")],-1),P=t("The integration of the preprocessor with the editor is handled via a "),E=t("ZAPP file profile"),L=t(". Such a profile might look like this:"),T=r(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> extended<span class="token punctuation">-</span>cobol
  <span class="token key atrule">type</span><span class="token punctuation">:</span> preprocessor
  <span class="token key atrule">language</span><span class="token punctuation">:</span> cobol
  <span class="token key atrule">location</span><span class="token punctuation">:</span> local
  <span class="token key atrule">settings</span><span class="token punctuation">:</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>JAVA_HOME<span class="token punctuation">}</span>/bin/java <span class="token punctuation">-</span>jar $<span class="token punctuation">{</span>WORKSPACE<span class="token punctuation">}</span>/preprocessor/my<span class="token punctuation">-</span>preprocessor/target/my<span class="token punctuation">-</span>preprocessor<span class="token punctuation">-</span>1.0<span class="token punctuation">-</span>SNAPSHOT.jar $<span class="token punctuation">{</span>input_file<span class="token punctuation">}</span> $<span class="token punctuation">{</span>output_file<span class="token punctuation">}</span>
    <span class="token key atrule">outputPath</span><span class="token punctuation">:</span> ./preprocessor/output
    <span class="token key atrule">fileExtension</span><span class="token punctuation">:</span> cee
    <span class="token key atrule">environmentVariables</span><span class="token punctuation">:</span>
      <span class="token key atrule">VARIABLE1</span><span class="token punctuation">:</span> value1
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>The <code>language</code> property is mandatory and allows the values <code>cobol</code> or <code>pl1</code> only.</p><p>In the settings object, the following properties can be used:</p>`,3),R=e("thead",null,[e("tr",null,[e("th",null,"Property"),e("th",null,"Description")])],-1),S=e("td",null,"command",-1),Z=t("The command line to be executed. You can mix the command line with "),z=t("ZAPP Variables"),I=t(" as well as use the predefined variables "),A=e("code",null,"${input_file}",-1),C=t(" and "),D=e("code",null,"${output_file}",-1),B=t(". You need to define "),H=e("code",null,"${JAVA_HOME}",-1),V=t(" and "),q=e("code",null,"${WORKSPACE}",-1),M=t(" in the example above as ZAPP variables. Environment variables can only be used by specifying them with the "),Q=e("code",null,"environmentVariables",-1),X=t(" property."),$=e("tr",null,[e("td",null,"outputPath"),e("td",null,"The base path in which the output file should be created. This path must be inside the current VS Code workspace so that the editor can see and process the files.")],-1),U=e("tr",null,[e("td",null,"fileExtension"),e("td",null,"The file extension to be used for the output files.")],-1),Y=e("tr",null,[e("td",null,"environmentVariables"),e("td",null,"An optional sub-object to specify the environment variables that should be created before executing the command.")],-1),N=r('<h3 id="running-the-preprocessor" tabindex="-1"><a class="header-anchor" href="#running-the-preprocessor" aria-hidden="true">#</a> Running the preprocessor</h3><p>After you specify the ZAPP profile, you can run the preprocessor in the following ways:</p><ol><li>Right-click and choose <strong>Execute local preprocessor command</strong> to manually run the preprocessor in the program file editor.</li><li>Automatically run the preprocessor via the VS Code user setting <code>zopeneditor.autoPreprocessor</code>. The setting can have one of the values: <ul><li>off: disables the automatic preprocessor execution.</li><li>open: when a program file is opened in the editor.</li><li>save: when a program file is saved in the editor.</li><li>both: when opening and saving a program file in the editor.</li></ul></li></ol><p>When the preprocessor command runs, a progress dialog with a Cancel button is displayed. When the preprocessor finishes, it refreshes the editor and any syntax errors that were caused by preprocessor statements should go away or, if they contained problems, will show those instead.</p><p>If the processor command execution failed and produced errors, a dialog will be shown with a button to open the Z Open Editor log file viewer which lists the detailed error message produced by the preprocessor command.</p><h3 id="using-the-preprocessor-output-in-the-editor" tabindex="-1"><a class="header-anchor" href="#using-the-preprocessor-output-in-the-editor" aria-hidden="true">#</a> Using the preprocessor output in the editor</h3><p>After the preprocessor is executed, you can hover the mouse of preprocessor statements in their program file to see the code that was generated for the statement. You can edit these statements and all other code in the program.</p><p>Syntax errors for preprocessor statements will not be available until the preprocessor runs again. Syntax errors for other regular COBOL or PL/I code will be shown while typing as usual in Z Open Editor.</p><p>To get a side-by-side view of the program before and after preprocessing, you can use the right-click menu option <strong>Compare preprocessor input and output files</strong>.</p><h2 id="remote-preprocessor" tabindex="-1"><a class="header-anchor" href="#remote-preprocessor" aria-hidden="true">#</a> Remote preprocessor</h2><h3 id="example-workflow-1" tabindex="-1"><a class="header-anchor" href="#example-workflow-1" aria-hidden="true">#</a> Example workflow</h3><p>The following workflow is written from the perspective of developer, Deb.</p><ol><li>Deb sets up a z/OS centric preprocessor data member on her remote z/OS development machine. This data member must be either a REXX or CLIST program.</li><li>Deb creates a <code>zapp.yaml</code> file with a preprocessor profile type. The profile specifies the TSO command for running the preprocessor on the currently edited program data member as well as the output dataset for the preprocessed data members.</li><li>Deb edits a dataset member with preprocessor statements in Z Open Editor through Zowe.</li><li>Deb either manually starts preprocessing the program via a right-click menu command or creates a user setting to automatically run the preprocessor on Save.</li><li>Z Open Editor uses Zowe to start the preprocessor command in the background and sends the output file to its parser.</li><li>Z Open Editor&#39;s COBOL or PL/I parser will compare the program in the editor with the output of the preprocessor command.</li><li>Deb hovers over processor statements in Z Open Editor, which displays the resulting COBOL or PL/I.</li><li>Deb continues editing the program in Z Open Editor. Z Open Editor continues to provide full language support for all the parts of the program that are not preprocessor statements.</li></ol>',13),j=t("To learn and explore this workflow, check out the example preprocessor and code samples in our Github repository at "),G={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor",target:"_blank",rel:"noopener noreferrer"},W=t("https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor"),F=t(". Review the "),J={href:"https://github.com/IBM/zopeneditor-sample/blob/wazi-main/preprocessor/README.md#remote-preprocessor-examples",target:"_blank",rel:"noopener noreferrer"},K=t("Readme"),ee=t(" file in this folder with detailed instructions for building and running the sample."),te=e("h3",{id:"requirements-for-the-preprocessor-1",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#requirements-for-the-preprocessor-1","aria-hidden":"true"},"#"),t(" Requirements for the preprocessor")],-1),oe=e("p",null,"To be able to integrate your preprocessor with Z Open Editor, it must fulfill these requirements:",-1),se=e("li",null,"It needs to run remotely on your z/OS machine.",-1),ne=e("li",null,"The remote preprocessor must be either a REXX or CLIST program.",-1),ae=t("You need a RSE API or z/OSMF Zowe profile available in your workspace and "),re=t("configured as a default for Z Open Editor"),ie=t("."),pe=t("You need to be able to run the processor via a Zowe TSO command. "),le=t("You can read more about TSO commands and Zowe TSO profiles "),ce={href:"https://ibm.github.io/zopeneditor-about/Docs/interact_zos_cli.html#run-interactive-tso-commands",target:"_blank",rel:"noopener noreferrer"},de=t("in the documentation"),he=t(", and explore some examples in this "),ue={href:"https://medium.com/zowe/zowe-ci-and-tso-commands-14e5445fca1e",target:"_blank",rel:"noopener noreferrer"},me=t("blog"),ge=t("."),be=e("li",null,"The TSO operation needs to create an output data member that contains valid COBOL or PL/I.",-1),fe=t("The program file to be processed needs to be in a PDS that is recognized by Z Open Editor to contain COBOL (PL/I) and the COBOL (PL/I) language support must be active. See "),_e=t("Remote file associations"),ke=t(" for more details."),we=e("h3",{id:"zapp-profile-1",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#zapp-profile-1","aria-hidden":"true"},"#"),t(" ZAPP profile")],-1),ye=t("The integration of the preprocessor with the editor is handled via a "),ve=t("ZAPP file profile"),Oe=t(". Such a profile could look like this:"),xe=r(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> extended<span class="token punctuation">-</span>cobol
  <span class="token key atrule">type</span><span class="token punctuation">:</span> preprocessor
  <span class="token key atrule">language</span><span class="token punctuation">:</span> cobol
  <span class="token key atrule">location</span><span class="token punctuation">:</span> mvs
  <span class="token key atrule">settings</span><span class="token punctuation">:</span>
    <span class="token key atrule">commandDataSet</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>.PREPROC.REXX.(PREPROC)
    <span class="token key atrule">tempDataHLQ</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>
    <span class="token key atrule">outputDataSet</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>.PREPROC.OUTPUT()
    <span class="token key atrule">commandParameters</span><span class="token punctuation">:</span> <span class="token string">&quot;var1=val1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The <code>language</code> property is mandatory and allows the values <code>cobol</code> or <code>pl1</code> only.</p><p>In the settings object the following properties can be used:</p>`,3),Pe=e("thead",null,[e("tr",null,[e("th",null,"Property"),e("th",null,"Description")])],-1),Ee=e("td",null,"commandDataSet",-1),Le=t("The data member to be executed. You can mix with "),Te=t("ZAPP Variables"),Re=t(". You need to define "),Se=e("code",null,"${HLQ}",-1),Ze=t(" in the example above as ZAPP variables. Environment variables can only be used by specifying them with the below "),ze=e("code",null,"commandParameters",-1),Ie=t(" property."),Ae=e("tr",null,[e("td",null,"tempDataHLQ"),e("td",null,[t("The High Level Qualifier (HLQ) to use to save an xml file that stores information for the "),e("code",null,"commandDataSet"),t(" to read from.")])],-1),Ce=e("tr",null,[e("td",null,"outputDataSet"),e("td",null,"The output dataset to save the data member output file of the preprocessor.")],-1),De=e("tr",null,[e("td",null,"commandParameters"),e("td",null,"An optional parameter to specify any command parameters that should be used when executing the command.")],-1),Be=r('<h3 id="running-the-preprocessor-1" tabindex="-1"><a class="header-anchor" href="#running-the-preprocessor-1" aria-hidden="true">#</a> Running the preprocessor</h3><p>After you specify the ZAPP profile, you can run the preprocessor in the following ways:</p><ol><li>Right-click and choose <strong>Execute remote preprocessor command</strong> to manually run the preprocessor in the program file editor.</li><li>Automatically run the preprocessor via the VS Code user setting <code>zopeneditor.autoPreprocessor</code>. The setting can have one of the values: <ul><li>off: disables the automatic preprocessor execution.</li><li>open: when a program file is opened in the editor.</li><li>save: when a program file is saved in the editor.</li><li>both: when opening and saving a program file in the editor.</li></ul></li></ol><p>When the preprocessor command runs, a progress dialog with a Cancel button is displayed. A sequential data member is created using the <code>tempDataHLQ</code> to store information for the preprocessor to read. When the preprocessor finishes, it deletes the sequential data member and then refreshes the editor and any syntax errors that were caused by preprocessor statements should go away or, if they contained problems, will show those instead.</p><p>If the processor command execution failed and produced errors, a dialog will be shown with a button to open the Z Open Editor log file viewer which lists the detailed error message produced by the preprocessor command and the sequential data member will not be deleted.</p><p>The following is an example of the sequential data member that gets created for the remote preprocessor to read based on the above ZAPP profile:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PROGRAM</span><span class="token punctuation">&gt;</span></span>HLQ.COBOL(PRINTAPP)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PROGRAM</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYSLIB</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SYSLIB</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPILEOPTIONS</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPILEOPTIONS</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUTPUT</span><span class="token punctuation">&gt;</span></span>HLQ.PREPROC.OUTPUT(PRINTAPP)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OUTPUT</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>The <code>${HLQ}</code> variable gets replaced with <code>HLQ</code> from user settings</li><li>The input data member&#39;s name was <code>PRINTAPP</code></li><li>There were no mvs cobol libraries or compiler options specified in the ZAPP property groups</li></ul><h3 id="using-the-preprocessor-output-in-the-editor-1" tabindex="-1"><a class="header-anchor" href="#using-the-preprocessor-output-in-the-editor-1" aria-hidden="true">#</a> Using the preprocessor output in the editor</h3><p>After the preprocessor is executed, you can hover the mouse of preprocessor statements in their program file to see the code that was generated for the statement. You can edit these statements and all other code in the program.</p><p>Syntax errors for preprocessor statements will not be available until the preprocessor runs again. Syntax errors for other regular COBOL or PL/I code will be shown while typing as usual in Z Open Editor.</p><p>To get a side-by-side view of the program before and after preprocessing, you can use the right-click menu option <strong>Compare preprocessor input and output files</strong>.</p><h3 id="using-the-preprocessor-for-expanding-pl-i-macros" tabindex="-1"><a class="header-anchor" href="#using-the-preprocessor-for-expanding-pl-i-macros" aria-hidden="true">#</a> Using the preprocessor for expanding PL/I macros</h3><p>Our sample Git repository contains a sample REXX program that can be called by Z Open Editor&#39;s preprocessor to expand PL/I macros defined in a program by invoking the PL/I compiler on z/OS. The resulting output produced by this REXX program is expanded source code that can be used by Z Open Editor&#39;s language server in the same way as any other preprocessor output presenting hovers as well as side-by side views with the expanded macros in the source code.</p>',14),He=t("To try and explore this sample, review the detailed instructions in the "),Ve={href:"https://github.com/IBM/zopeneditor-sample/blob/wazi-main/preprocessor/README.md#expanding-pli-macros-using-a-remote-preprocessor",target:"_blank",rel:"noopener noreferrer"},qe=t("Preprocessor Readme of our Github repository"),Me=t("."),Qe=r('<h2 id="limitations" tabindex="-1"><a class="header-anchor" href="#limitations" aria-hidden="true">#</a> Limitations</h2><p>Restriction: Several limitations are associated with using a preprocessor within Z Open Editor:</p><ul><li>COBOL code formatting will be disabled for files that contain preprocessor statements.</li><li>Not all preprocessor statements within a COBOL EXEC block might be identified.</li><li>All preprocessor statements might not be identified if the code is reorganized.</li><li>Preprocessor statements that modify text in another location of a program might not be identified.</li><li>Real-time syntax checking of programs that contain preprocessor statements that contain only the beginning or ending of a language comment might not be identified.</li><li>Remote preprocessor command dataset members must be either REXX or CLIST files.</li><li>The side-by-side comparison of program and preprocessed output is not yet available for the remote preprocessor support.</li></ul>',3);function Xe($e,Ue){const s=i("ExternalLinkIcon"),n=i("RouterLink");return p(),l(c,null,[u,e("p",null,[m,e("a",g,[b,o(s)]),f,e("a",_,[k,o(s)]),w]),y,v,O,x,e("p",null,[P,o(n,{to:"/Docs/zapp.html"},{default:a(()=>[E]),_:1}),L]),T,e("table",null,[R,e("tbody",null,[e("tr",null,[S,e("td",null,[Z,o(n,{to:"/Docs/zapp.html#configure-zapp-files-with-user-setting-variables"},{default:a(()=>[z]),_:1}),I,A,C,D,B,H,V,q,M,Q,X])]),$,U,Y])]),N,e("p",null,[j,e("a",G,[W,o(s)]),F,e("a",J,[K,o(s)]),ee]),te,oe,e("ul",null,[se,ne,e("li",null,[ae,o(n,{to:"/Docs/interact_zos_zopeneditor.html"},{default:a(()=>[re]),_:1}),ie]),e("li",null,[pe,e("ul",null,[e("li",null,[le,e("a",ce,[de,o(s)]),he,e("a",ue,[me,o(s)]),ge])])]),be,e("li",null,[fe,o(n,{to:"/Docs/setting_fileassociations.html#remote-file-associations"},{default:a(()=>[_e]),_:1}),ke])]),we,e("p",null,[ye,o(n,{to:"/Docs/zapp.html"},{default:a(()=>[ve]),_:1}),Oe]),xe,e("table",null,[Pe,e("tbody",null,[e("tr",null,[Ee,e("td",null,[Le,o(n,{to:"/Docs/zapp.html#configure-zapp-files-with-user-setting-variables"},{default:a(()=>[Te]),_:1}),Re,Se,Ze,ze,Ie])]),Ae,Ce,De])]),Be,e("p",null,[He,e("a",Ve,[qe,o(s)]),Me]),Qe],64)}var je=d(h,[["render",Xe]]);export{je as default};
