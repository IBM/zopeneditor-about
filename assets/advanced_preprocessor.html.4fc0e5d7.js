import{r as i,o as p,a as l,b as e,d as s,w as a,F as c,c as r,e as t}from"./app.53665350.js";import{_ as h}from"./plugin-vue_export-helper.21dcd24c.js";const d={},u=r('<h1 id="preprocessor-support" tabindex="-1"><a class="header-anchor" href="#preprocessor-support" aria-hidden="true">#</a> Preprocessor support</h1><p>Z Open Editor provides the advanced capability to integrate parsing of COBOL programs with a custom preprocessor to allow editing programs that contain such preprocessor statements without causing the editor to show syntax errors. The preprocessor would be executed on either a developer machine by Z Open Editor in the background (local) or a z/OS system (remote), taking COBOL with custom code and transforming it to valid COBOL. Users can then edit such programs by using the preprocessor output to still provide full language support such as code completion, syntax error highlighting, and outline view. The editor would not learn the preprocessor language, but rather ensure that the resulting preprocessed output is still valid COBOL.</p><h2 id="local-preprocessor" tabindex="-1"><a class="header-anchor" href="#local-preprocessor" aria-hidden="true">#</a> Local preprocessor</h2><h3 id="example-workflow" tabindex="-1"><a class="header-anchor" href="#example-workflow" aria-hidden="true">#</a> Example workflow</h3><p>The following workflow is written from the perspective of COBOL developer, Deb.</p><ol><li>Deb installs a command-line centric preprocessor program on her local development machine.</li><li>Deb creates a <code>zapp.yaml</code> file with a preprocessor profile type. The profile specifies the command-line for running the preprocessor on the currently edited program file as well as the output path for the preprocessed program files.</li><li>Deb edits a program file with preprocessor statements in Z Open Editor.</li><li>Deb either manually starts preprocessing the program via a right-click menu command or creates a user setting to automatically run the preprocessor on Save.</li><li>Z Open Editor starts the preprocessor command in the background and sends the output file to its COBOL parser.</li><li>Z Open Editor&#39;s COBOL parser will compare the program in the editor with the output of the preprocessor command.</li><li>Deb hovers over processor statements in Z Open Editor, which displays the resulting COBOL.</li><li>Deb continues editing the program in Z Open Editor. Z Open Editor continues to provide full language support for all the parts of the program that are not preprocessor statements.</li></ol>',6),m=t("To learn and explore this sample workflow, check out the example preprocessor and code samples in our Github repository at "),f={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor",target:"_blank",rel:"noopener noreferrer"},g=t("https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor"),b=t(". Review the "),_={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor/README.md",target:"_blank",rel:"noopener noreferrer"},k=t("Readme"),w=t(" file in this folder with detailed instructions for building and running the sample."),y=e("h3",{id:"requirements-for-the-preprocessor",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#requirements-for-the-preprocessor","aria-hidden":"true"},"#"),t(" Requirements for the preprocessor")],-1),O=e("p",null,"To be able to integrate your preprocessor with Z Open Editor, it must fulfill these requirements:",-1),v=e("ul",null,[e("li",null,"It needs to run locally on your development machine where Z Open Editor is running."),e("li",null,"You need to be able to run the processor via command-line."),e("li",null,"The command-line operation needs to create an output file that contains valid COBOL."),e("li",null,"The output path can be computed by specifying a new file extension to be used with the program file name.")],-1),x=e("h3",{id:"zapp-profile",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#zapp-profile","aria-hidden":"true"},"#"),t(" ZAPP profile")],-1),P=t("The integration of the preprocessor with the editor is handled via a "),T=t("ZAPP file profile"),E=t(". Such a profile might look like this:"),L=r(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> extended<span class="token punctuation">-</span>cobol
  <span class="token key atrule">type</span><span class="token punctuation">:</span> preprocessor
  <span class="token key atrule">location</span><span class="token punctuation">:</span> local
  <span class="token key atrule">settings</span><span class="token punctuation">:</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>JAVA_HOME<span class="token punctuation">}</span>/bin/java <span class="token punctuation">-</span>jar $<span class="token punctuation">{</span>WORKSPACE<span class="token punctuation">}</span>/preprocessor/my<span class="token punctuation">-</span>preprocessor/target/my<span class="token punctuation">-</span>preprocessor<span class="token punctuation">-</span>1.0<span class="token punctuation">-</span>SNAPSHOT.jar $<span class="token punctuation">{</span>input_file<span class="token punctuation">}</span> $<span class="token punctuation">{</span>output_file<span class="token punctuation">}</span>
    <span class="token key atrule">outputPath</span><span class="token punctuation">:</span> ./preprocessor/output
    <span class="token key atrule">fileExtension</span><span class="token punctuation">:</span> cee
    <span class="token key atrule">environmentVariables</span><span class="token punctuation">:</span>
      <span class="token key atrule">VARIABLE1</span><span class="token punctuation">:</span> value1
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>In the settings object, the following properties can be used:</p>`,2),C=e("thead",null,[e("tr",null,[e("th",null,"Property"),e("th",null,"Description")])],-1),S=e("td",null,"command",-1),R=t("The command line to be executed. You can mix the command line with "),A=t("ZAPP Variables"),Z=t(" as well as use the predefined variables "),z=e("code",null,"${input_file}",-1),D=t(" and "),B=e("code",null,"${output_file}",-1),I=t(". You need to define "),H=e("code",null,"${JAVA_HOME}",-1),V=t(" and "),q=e("code",null,"${WORKSPACE}",-1),Q=t(" in the example above as ZAPP variables. Environment variables can only be used by specifying them with the "),$=e("code",null,"environmentVariables",-1),N=t(" property."),U=e("tr",null,[e("td",null,"outputPath"),e("td",null,"The base path in which the output file should be created. This path must be inside the current VS Code workspace so that the editor can see and process the files.")],-1),Y=e("tr",null,[e("td",null,"fileExtension"),e("td",null,"The file extension to be used for the output files.")],-1),X=e("tr",null,[e("td",null,"environmentVariables"),e("td",null,"An optional sub-object to specify the environment variables that should be created before executing the command.")],-1),M=r('<h3 id="running-the-preprocessor" tabindex="-1"><a class="header-anchor" href="#running-the-preprocessor" aria-hidden="true">#</a> Running the preprocessor</h3><p>After you specify the ZAPP profile, you can run the preprocessor in the following ways:</p><ol><li>Right-click and choose <strong>Execute local preprocessor command</strong> to manually run the preprocessor in the program file editor.</li><li>Automatically run the preprocessor via the VS Code user setting <code>zopeneditor.cobol.autoPreprocessor</code>. The setting can have one of the values: <ul><li>off: disables the automatic preprocessor execution.</li><li>open: when a program file is opened in the editor.</li><li>save: when a program file is saved in the editor.</li><li>both: when opening and saving a program file in the editor.</li></ul></li></ol><p>When the preprocessor command runs, a progress bar is displayed. When the preprocessor finishes, it refreshes the editor and any syntax errors that were caused by preprocessor statements should go away or, if they contained problems, will show those instead.</p><p>If the processor command execution failed and produced errors, a dialog will be shown with a button to open the Z Open Editor log file viewer which lists the detailed error message produced by the preprocessor command.</p><h3 id="using-the-preprocessor-output-in-the-editor" tabindex="-1"><a class="header-anchor" href="#using-the-preprocessor-output-in-the-editor" aria-hidden="true">#</a> Using the preprocessor output in the editor</h3><p>After the preprocessor is executed, you can hover the mouse of preprocessor statements in their program file to see the COBOL code that was generated for the statement. You can edit these statements and all other COBOL code in the program.</p><p>Syntax errors for preprocessor statements will not be available until the preprocessor runs again. Syntax errors for other regular COBOL will be shown while typing as usual in Z Open Editor.</p><p>To get a side-by-side view of the program before and after preprocessing, you can use the right-click menu option <strong>Compare preprocessor input and output files</strong>.</p><h2 id="remote-preprocessor" tabindex="-1"><a class="header-anchor" href="#remote-preprocessor" aria-hidden="true">#</a> Remote preprocessor</h2><h3 id="example-workflow-1" tabindex="-1"><a class="header-anchor" href="#example-workflow-1" aria-hidden="true">#</a> Example workflow</h3><p>The following workflow is written from the perspective of COBOL developer, Deb.</p><ol><li>Deb sets up a z/OS centric preprocessor data member on her remote z/OS development machine. This data member must be either a REXX or CLIST program.</li><li>Deb creates a <code>zapp.yaml</code> file with a preprocessor profile type. The profile specifies the TSO command for running the preprocessor on the currently edited program data member as well as the output dataset for the preprocessed data members.</li><li>Deb edits a dataset member with preprocessor statements in Z Open Editor through Zowe.</li><li>Deb either manually starts preprocessing the program via a right-click menu command or creates a user setting to automatically run the preprocessor on Save.</li><li>Z Open Editor uses Zowe to start the preprocessor command in the background and sends the output file to its COBOL parser.</li><li>Z Open Editor&#39;s COBOL parser will compare the program in the editor with the output of the preprocessor command.</li><li>Deb hovers over processor statements in Z Open Editor, which displays the resulting COBOL.</li><li>Deb continues editing the program in Z Open Editor. Z Open Editor continues to provide full language support for all the parts of the program that are not preprocessor statements.</li></ol>',13),j=t("To learn and explore this sample workflow, check out the example preprocessor and code samples in our Github repository at "),W={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor",target:"_blank",rel:"noopener noreferrer"},G=t("https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor"),F=t(". Review the "),J={href:"https://github.com/ibm/zopeneditor-sample/tree/wazi-main/preprocessor/README.md",target:"_blank",rel:"noopener noreferrer"},K=t("Readme"),ee=t(" file in this folder with detailed instructions for building and running the sample."),te=e("h3",{id:"requirements-for-the-preprocessor-1",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#requirements-for-the-preprocessor-1","aria-hidden":"true"},"#"),t(" Requirements for the preprocessor")],-1),se=e("p",null,"To be able to integrate your preprocessor with Z Open Editor, it must fulfill these requirements:",-1),oe=e("li",null,"It needs to run remotely on your z/OS machine.",-1),ne=e("li",null,"The remote preprocessor must be either a REXX or CLIST program",-1),ae=t("You need to be able to run the processor via TSO command. "),re=t("You can read more about TSO commands and Zowe TSO profiles "),ie={href:"https://ibm.github.io/zopeneditor-about/Docs/interact_zos_cli.html#run-interactive-tso-commands",target:"_blank",rel:"noopener noreferrer"},pe=t("in the documentation"),le=t(", and explore some examples in this "),ce={href:"https://medium.com/zowe/zowe-ci-and-tso-commands-14e5445fca1e",target:"_blank",rel:"noopener noreferrer"},he=t("blog"),de=t("."),ue=e("li",null,"The TSO operation needs to create an output data member that contains valid COBOL.",-1),me=t("The program file to be processed needs to be in a PDS that is recognized by Z Open Editor to contain COBOL and the COBOL language support must be active. See "),fe=t("Remote file associations"),ge=t(" for more details."),be=e("h3",{id:"zapp-profile-1",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#zapp-profile-1","aria-hidden":"true"},"#"),t(" ZAPP profile")],-1),_e=t("The integration of the preprocessor with the editor is handled via a "),ke=t("ZAPP file profile"),we=t(". Such a profile could look like this:"),ye=r(`<div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> extended<span class="token punctuation">-</span>cobol
  <span class="token key atrule">type</span><span class="token punctuation">:</span> preprocessor
  <span class="token key atrule">location</span><span class="token punctuation">:</span> mvs
  <span class="token key atrule">settings</span><span class="token punctuation">:</span>
    <span class="token key atrule">commandDataSet</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>.PREPROC.REXX.(PREPROC)
    <span class="token key atrule">tempDataHLQ</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>
    <span class="token key atrule">outputDataSet</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HLQ<span class="token punctuation">}</span>.PREPROC.OUTPUT()
    <span class="token key atrule">commandParameters</span><span class="token punctuation">:</span> <span class="token string">&quot;var1=val1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>In the settings object the following properties can be used:</p>`,2),Oe=e("thead",null,[e("tr",null,[e("th",null,"Property"),e("th",null,"Description")])],-1),ve=e("td",null,"commandDataSet",-1),xe=t("The data member to be executed. You can mix with "),Pe=t("ZAPP Variables"),Te=t(". You need to define "),Ee=e("code",null,"${HLQ}",-1),Le=t(" in the example above as ZAPP variables. Environment variables can only be used by specifying them with the below "),Ce=e("code",null,"commandParameters",-1),Se=t(" property."),Re=e("tr",null,[e("td",null,"tempDataHLQ"),e("td",null,[t("The High Level Qualifier (HLQ) to use to save an xml file that stores information for the "),e("code",null,"commandDataSet"),t(" to read from.")])],-1),Ae=e("tr",null,[e("td",null,"outputDataSet"),e("td",null,"The output dataset to save the data member output file of the preprocessor.")],-1),Ze=e("tr",null,[e("td",null,"commandParameters"),e("td",null,"An optional parameter to specify any command parameters that should be used when executing the command.")],-1),ze=r('<h3 id="running-the-preprocessor-1" tabindex="-1"><a class="header-anchor" href="#running-the-preprocessor-1" aria-hidden="true">#</a> Running the preprocessor</h3><p>After you specify the ZAPP profile, you can run the preprocessor in the following ways:</p><ol><li>Right-click and choose <strong>Execute remote preprocessor command</strong> to manually run the preprocessor in the program file editor.</li><li>Automatically run the preprocessor via the VS Code user setting <code>zopeneditor.cobol.autoPreprocessor</code>. The setting can have one of the values: <ul><li>off: disables the automatic preprocessor execution.</li><li>open: when a program file is opened in the editor.</li><li>save: when a program file is saved in the editor.</li><li>both: when opening and saving a program file in the editor.</li></ul></li></ol><p>When the preprocessor command runs, a progress bar is displayed. A sequential data member is created using the <code>tempDataHLQ</code> to store information for the preprocessor to read. When the preprocessor finishes, it deletes the sequential data member and then refreshes the editor and any syntax errors that were caused by preprocessor statements should go away or, if they contained problems, will show those instead.</p><p>If the processor command execution failed and produced errors, a dialog will be shown with a button to open the Z Open Editor log file viewer which lists the detailed error message produced by the preprocessor command and the sequential data member will not be deleted.</p><p>The following is an example of the sequential data member that gets created for the remote preprocessor to read based on the above ZAPP profile:</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PROGRAM</span><span class="token punctuation">&gt;</span></span>HLQ.COBOL(PRINTAPP)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PROGRAM</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYSLIB</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SYSLIB</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPILEOPTIONS</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPILEOPTIONS</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUTPUT</span><span class="token punctuation">&gt;</span></span>HLQ.PREPROC.OUTPUT(PRINTAPP)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OUTPUT</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>The <code>${HLQ}</code> variable gets replaced with <code>HLQ</code> from user settings</li><li>The input data member&#39;s name was <code>PRINTAPP</code></li><li>There were no mvs cobol libraries or compiler options specified in the ZAPP property groups</li></ul><h3 id="using-the-preprocessor-output-in-the-editor-1" tabindex="-1"><a class="header-anchor" href="#using-the-preprocessor-output-in-the-editor-1" aria-hidden="true">#</a> Using the preprocessor output in the editor</h3><p>After the preprocessor is executed, you can hover the mouse of preprocessor statements in their program file to see the COBOL code that was generated for the statement. You can edit these statements and all other COBOL code in the program.</p><p>Syntax errors for preprocessor statements will not be available until the preprocessor runs again. Syntax errors for other regular COBOL will be shown while typing as usual in Z Open Editor.</p><h2 id="limitations" tabindex="-1"><a class="header-anchor" href="#limitations" aria-hidden="true">#</a> Limitations</h2><p>Restriction: Several limitations are associated with using a preprocessor within Z Open Editor:</p><ul><li>Code formatting will be disabled for files that contain preprocessor statements.</li><li>Not all preprocessor statements within an EXEC block might be identified.</li><li>All preprocessor statements might not be identified if the code is reorganized.</li><li>Preprocessor statements that modify text in another location of a program might not be identified.</li><li>Real-time syntax checking of programs that contain preprocessor statements that contain only the beginning or ending of a language comment might not be identified.</li><li>Remote preprocessor command dataset members must be either REXX or CLIST files.</li><li>The side-by-side comparison of program and preprocessed output is not yet available for the remote preprocessor support.</li></ul>',14);function De(Be,Ie){const o=i("ExternalLinkIcon"),n=i("RouterLink");return p(),l(c,null,[u,e("p",null,[m,e("a",f,[g,s(o)]),b,e("a",_,[k,s(o)]),w]),y,O,v,x,e("p",null,[P,s(n,{to:"/Docs/zapp.html"},{default:a(()=>[T]),_:1}),E]),L,e("table",null,[C,e("tbody",null,[e("tr",null,[S,e("td",null,[R,s(n,{to:"/Docs/zapp.html#configure-zapp-files-with-user-setting-variables"},{default:a(()=>[A]),_:1}),Z,z,D,B,I,H,V,q,Q,$,N])]),U,Y,X])]),M,e("p",null,[j,e("a",W,[G,s(o)]),F,e("a",J,[K,s(o)]),ee]),te,se,e("ul",null,[oe,ne,e("li",null,[ae,e("ul",null,[e("li",null,[re,e("a",ie,[pe,s(o)]),le,e("a",ce,[he,s(o)]),de])])]),ue,e("li",null,[me,s(n,{to:"/Docs/setting_fileassociations.html#remote-file-associations"},{default:a(()=>[fe]),_:1}),ge])]),be,e("p",null,[_e,s(n,{to:"/Docs/zapp.html"},{default:a(()=>[ke]),_:1}),we]),ye,e("table",null,[Oe,e("tbody",null,[e("tr",null,[ve,e("td",null,[xe,s(n,{to:"/Docs/zapp.html#configure-zapp-files-with-user-setting-variables"},{default:a(()=>[Pe]),_:1}),Te,Ee,Le,Ce,Se])]),Re,Ae,Ze])]),ze],64)}var qe=h(d,[["render",De]]);export{qe as default};
