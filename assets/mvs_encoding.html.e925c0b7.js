import{r as i,o as l,a as r,b as n,d as s,w as o,F as c,e,c as p}from"./app.6ecc27f4.js";import{_ as d}from"./plugin-vue_export-helper.21dcd24c.js";var u="/zopeneditor-about/assets/zapp-rseapi.e541dd7d.png";const m={},h=n("h1",{id:"mvs-ebcdic-code-pages-and-mappings-files",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#mvs-ebcdic-code-pages-and-mappings-files","aria-hidden":"true"},"#"),e(" MVS EBCDIC code pages and mappings files")],-1),f=e("IBM Z Open Editor and RSE API Plug-in for Zowe CLI (RSE CLI plug-in) can handle EBCDIC code page conversion mappings for MVS files. You can set an encoding default in the RSE profile, use an encoding tag with Upload and Download MVS commands, and use mappings files either provided by the RSE API host component or used at a project level. See "),g={href:"https://www.ibm.com/docs/en/cloud-paks/z-modernization-stack/2022.3?topic=mapping-supported-host-code-pages",target:"_blank",rel:"noopener noreferrer"},b=e("this page with the list of all the supported code pages"),k=e("."),w=n("p",null,[e("The RSE API Server provides the capability to manage mappings files that allow defining how MVS files should be converted when uploaded and downloaded. These mappings do not cover USS; we recommend and use in IBM User Build a "),n("code",null,".gitattributes"),e(" file for specifying the USS mappings.")],-1),y=e("RSE CLI plug-in provides the ability to get a default mappings file, which is maintained by the RSE API server administrator, from the server that can be downloaded using the "),_=e("RSE CLI plug-in command"),v=e(),I=n("code",null,"zowe rse check conversion-mappings",-1),S=e(". You can make personal modifications to this file in the "),x=n("code",null,"~/.zowe/profiles/rse",-1),E=e(" folder, and then have our tools use this mappings file automatically to interact with the server. The mapping is consistent with a similar behavior offered in IBM Developer for z/OS (IDz) via its user interface."),M=p(`<h2 id="capabilities" tabindex="-1"><a class="header-anchor" href="#capabilities" aria-hidden="true">#</a> Capabilities</h2><p>In addition to mappings files that are stored in the user&#39;s <code>.zowe</code> directory and used by the RSE CLI plug-in, <a href="./zapp">ZAPP</a> provides the same ability of defining mappings using the same schema, but offers YAML as additional syntax. This allows teams to share these mappings for their applications and make them part of the source code that could be stored in a Git repository or other SCM. ZAPP files can either be in YAML or JSON syntax; however, it is recommended to have your ZAPP file in one syntax only, not both, within the same project or directory.</p><h2 id="ibm-rse-api-plug-in-for-zowe-cli-examples" tabindex="-1"><a class="header-anchor" href="#ibm-rse-api-plug-in-for-zowe-cli-examples" aria-hidden="true">#</a> IBM RSE API Plug-in for Zowe CLI examples</h2><p>Many commands of the IBM RSE API Plug-in for Zowe CLI have additional parameters for specifying a code page directly or specifying a mappings file to be used for computing the code page encoding.</p><p>For example, assuming the member <code>SAM1</code> was written and stored on MVS using the IBM-273 EBCDIC encoding, you can work with it via the following commands.</p><ul><li><p>To download the member <code>SAM1</code> as a UTF-8 file (converting from IBM-273), issue the following command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>zowe rse download ds <span class="token string">&quot;IBMUSER.SAMPLE.COBOL(SAM1)&quot;</span> --ec IBM-273
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>To upload the member <code>SAM1</code> using the IBM-273 EBCDIC encoding, issue the following command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code> zowe rse upload ftds ./ibmuser/sample/cobol/SAM1.txt <span class="token string">&quot;IBMUSER.SAMPLE.COBOL(SAM1)&quot;</span> --ec IBM-273
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul><p>To download the default mappings file provided by your RSE API server administrator, issue the following command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>zowe rse check conversion-mappings
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>The downloaded mappings file will be placed in <code>~/.zowe/profiles/rse/conversion-mappings.json</code>. You can add your personal conversion preferences to this file and the updates will be automatically used by all your RSE CLI plug-in commands without the need to specify a command line parameter.</p><p>However, if you manage more than one such file, for example for different projects, or you even prefer defining such mappings in a ZAPP file, then you can specify the file to use with a command line parameter as well:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>zowe rse upload ftds ./ibmuser/sample/cobol/SAM1.txt <span class="token string">&quot;IBMUSER.SAMPLE.COBOL(SAM1)&quot;</span> --maps ./zapp.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="mvs-encoding-precedence-rules" tabindex="-1"><a class="header-anchor" href="#mvs-encoding-precedence-rules" aria-hidden="true">#</a> MVS encoding precedence rules</h2><p>Tools such as the RSE CLI plug-in or Z Open Editor find mappings following these precedence rules with some rules applied to CLI only:</p><ol><li>(CLI only) An <code>encoding | ec</code> parameter provided by the command should always have highest precedence, for example <code>--encoding IBM-273</code>.</li><li>(CLI only) An encoding found in a file that was provided via the parameter <code>mappings-file | maps</code>, for example <code>--mappings-file ~/myproject/zapp.yaml</code>.</li><li>An encoding found in the current workspace in a file named <code>zapp.yaml</code> or <code>zapp.json</code>.</li><li>An encoding found in the default mappings file in the user&#39;s <code>~/.zowe/profiles/rse</code> folder that was downloaded via command line.</li><li>An encoding specified in the Zowe CLI profile itself.</li><li>No encoding is specified, resulting in the use of the server default mappings file residing on the server.</li></ol><h2 id="mappings-file-schema" tabindex="-1"><a class="header-anchor" href="#mappings-file-schema" aria-hidden="true">#</a> Mappings file schema</h2><p>The JSON schema for defining RSE CLI plug-in profiles simply consists of an array of mappings and a default encoding to be used if none of the mappings provided apply. The mappings can be provided as a simple array called <code>mappings</code> of mappings objects in a JSON file or as part of a ZAPP profile with settings as shown in the diagram below. See examples further below.</p><p><img src="`+u+'" alt="Fig.1: ZAPP Schema Model for RSE API"><strong>Fig.1: ZAPP Schema Model for RSE API</strong></p><p>When reading these mappings the following validation and interpretation rules apply:</p><ul><li>There can only be one ZAPP <code>rse-mappings</code> profile of type <code>rseapi</code> in a ZAPP file.</li><li>Member mappings consist of the same properties as the mappings except for the member mappings itself, that is, only one level of nesting.</li><li>When member mappings are matched, they will override values of the parent mappings. For example, the parent data set mapping might define a default encoding that is true for members that do not match, but if a member mapping is valid, any encoding value specified there will override the parent mapping.</li><li>The <code>resource</code> property is a mandatory property for data set and member mappings. <strong>Note</strong>: Mapping against members in all data sets is not possible for performance reasons.</li><li>The <code>resource</code> of the data set parent represents a pattern on the data set name.</li><li>The <code>resource</code> of the member mapping represents a pattern on the member name.</li><li>If no <code>transfer</code> is specified for a resource mapping, the default is text.</li><li>If no <code>encoding</code> is defined for text, it will use the default specified in the local mappings file. If that is missing, it will use the default of the server.</li><li>If a <code>transfer</code> is specified as binary, the encoding will be ignored.</li><li>The <code>extension</code> property is only used for downloading files to determine which extension to append to the member name, which is to ensure editors can open the file correctly. For uploading files, only the mappings to resources are relevant.</li><li>An <code>extension</code> entry can be present either in a member mapping or the data set mapping. If it is in both mappings, the member mapping takes precedence. If it is missing completely in mappings, the first resource match will be used.</li></ul>',19),q=e("Resources can be specified following the rules defined in Step 5 of the z/OS Explorer docs for "),A={href:"https://www.ibm.com/docs/en/cloud-paks/z-modernization-stack/2022.3?topic=mapping-data-sets-partitioned-data-set-members",target:"_blank",rel:"noopener noreferrer"},C=e("Mapping data sets and partitioned data set members"),B=e("."),P=p(`<p>There are two wildcards allowed: <code>**</code> and <code>*</code></p><ul><li><code>**</code> matches in data set names across multiple name hierarchies. It cannot be used for member names. For example: <code>**ERROR**</code> matches: <ul><li><code>USER.ERROR.TEST</code></li><li><code>USER.A.B.MYERROR.ABC</code></li><li><code>USER.A.B.MYERROR2.ABC</code></li></ul></li><li><code>*</code> matches within a data set name segment or the member name. For example, <code>USER**COB*</code> matches: <ul><li><code>USER.A.COB</code></li><li><code>USER.A.B.COBOL</code></li><li><code>USER.A.B.ACOBCOPY</code></li></ul></li></ul><h2 id="example-json-mappings-file" tabindex="-1"><a class="header-anchor" href="#example-json-mappings-file" aria-hidden="true">#</a> Example JSON mappings file</h2><p>The following shows a sample mappings file using JSON that you could place in your <code>~/.zowe/profiles/rse</code> as <code>conversion-mappings.json</code>:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;**.SAMPLE.COB**&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;extension&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cbl&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;transfer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;encoding&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IBM-273&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;memberMappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;extension&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dat&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;transfer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;binary&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EIC*&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;**PLI*&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;extension&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pl1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;transfer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;encoding&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IBM-500&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;default.encoding&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IBM-1047&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>This file defines that files located in data sets containing the string <code>.SAMPLE.COB</code> in their fully qualified name such as <code>USER1.SAMPLE.COBOL</code> would be transferred as text assuming an IBM-273 EBCDIC code page (Austria/Germany) on MVS. Hence, downloading a data set member with an RSE CLI plug-in command or Zowe Explorer using an RSE profile would therefore convert the content by RSE API from IBM-273 EBCDIC to a UTF-8 file, as that is the format Z Open Editor requires files to be in. Uploading such a file would convert the UTF-8 back to IBM-273 EBCDIC. The <code>extension</code> property, which is currently only supported by the CLI, specifies that the downloaded data set member would be stored as a file with a <code>.cbl</code> file extension.</p><p>In addition to the default rule for <code>**.SAMPLE.COB**</code> data sets, you see a nested <code>memberMappings</code> subrule that provides a refinement: If the member name contains <code>EIC</code> as a substring then the file will not be converted from IBM-273, but treated as a binary instead. This allows you to use data sets with members of different types.</p><p>Furthermore, the example shows how members in data sets that contain <code>PLI</code> in their names would be converted using IBM-500 (Belgium/Canada/Switzerland) as well as that in all other cases the default conversion code page would be IBM-1047.</p><h2 id="example-zapp-file" tabindex="-1"><a class="header-anchor" href="#example-zapp-file" aria-hidden="true">#</a> Example ZAPP file</h2><p>In a <code>zapp.yaml</code> file, you can specify the same mapping described in the previous section by defining a ZAPP profile of type <code>rseapi</code>. The <code>zapp.yaml</code> for this particular specification would contain text as follows:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> sam
<span class="token key atrule">version</span><span class="token punctuation">:</span> 1.1.0

<span class="token key atrule">profiles</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> RSE<span class="token punctuation">-</span>Mappings
    <span class="token key atrule">type</span><span class="token punctuation">:</span> rseapi
    <span class="token key atrule">settings</span><span class="token punctuation">:</span>
      <span class="token key atrule">mappings</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">resource</span><span class="token punctuation">:</span> <span class="token string">&quot;**.SAMPLE.COB**&quot;</span>
          <span class="token key atrule">extension</span><span class="token punctuation">:</span> cbl
          <span class="token key atrule">transfer</span><span class="token punctuation">:</span> text
          <span class="token key atrule">encoding</span><span class="token punctuation">:</span> IBM<span class="token punctuation">-</span><span class="token number">273</span>
          <span class="token key atrule">memberMappings</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">extension</span><span class="token punctuation">:</span> dat
              <span class="token key atrule">transfer</span><span class="token punctuation">:</span> binary
              <span class="token key atrule">resource</span><span class="token punctuation">:</span> <span class="token string">&quot;*DAT&quot;</span>
        <span class="token punctuation">-</span> <span class="token key atrule">resource</span><span class="token punctuation">:</span> <span class="token string">&quot;**PLI*&quot;</span>
          <span class="token key atrule">extension</span><span class="token punctuation">:</span> pl1
          <span class="token key atrule">transfer</span><span class="token punctuation">:</span> text
          <span class="token key atrule">encoding</span><span class="token punctuation">:</span> IBM<span class="token punctuation">-</span><span class="token number">500</span>
      <span class="token key atrule">default.encoding</span><span class="token punctuation">:</span> IBM<span class="token punctuation">-</span><span class="token number">1047</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="using-mappings-files-with-z-open-editor" tabindex="-1"><a class="header-anchor" href="#using-mappings-files-with-z-open-editor" aria-hidden="true">#</a> Using mappings files with Z Open Editor</h2>`,12),R=e("Mappings files are not only used by RSE CLI plug-in commands, but also by Z Open Editor remote include file resolution operations. When you define a property group either in your "),z=e("ZAPP"),L=e(" file or "),O=n("a",{href:"./setting_propertygroup"},"Settings",-1),T=e(", the retrieval of include files or copybooks will use mappings files based on the precedence rules defined above. For example, if you define mappings in a "),Z=n("code",null,"zapp.yaml",-1),U=e(" file in your workspace, these mappings will be used. If you do not have a ZAPP file, but have a personal mappings file in "),D=n("code",null,"~/.zowe/profiles/rse/conversion-mappings.json",-1),F=e(", the personal file will be automatically used."),j=n("h2",{id:"using-mappings-files-with-zowe-explorer",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#using-mappings-files-with-zowe-explorer","aria-hidden":"true"},"#"),e(" Using mappings files with Zowe Explorer")],-1),N=e("Zowe Explorer allows you to navigate your data sets and open data set members in the editor with a simple click. When you use Zowe Explorer with an RSE profile, conversion mappings can be used as well. To enable this, you need specify the absolute location of the mappings file to use in your user settings. The setting is called "),V=n("code",null,"zopeneditor.zowe.defaultRseConversionMappingsFile",-1),Y=e(". You can find it in the IBM Z Open Editor settings together with the other "),J=e("Zowe-related settings"),W=e(" such as the "),G=n("code",null,"defaultCliProfile",-1),H=e(". Conversion mappings defined in either a JSON-formatted RSE API user mappings file or a ZAPP file will override an encoding specified in a Zowe profile."),K=n("h2",{id:"rse-cli-plug-in-logging",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#rse-cli-plug-in-logging","aria-hidden":"true"},"#"),e(" RSE CLI plug-in logging")],-1),Q=n("p",null,[e("When using encoding and mappings files with the RSE CLI plug-in commands, logging will be written and found at "),n("code",null,"~/.zowe/zowe/logs/zowe.log"),e(". This log file will contain details about the encoding precedence that was used during upload and download of MVS files, the location of the mappings file if available, and the outcome of the encoding or transfer type that was chosen according to the previously-mentioned values.")],-1),X=n("p",null,[e("In addition to the logging, you can also refer to the Upload and Download output to troubleshoot. If binary transfer was used, the output includes a binary value of "),n("code",null,"true"),e(". If the file was transferred as text and an encoding value was used, the output includes an encoding value for each file.")],-1);function $(ee,ne){const t=i("ExternalLinkIcon"),a=i("RouterLink");return l(),r(c,null,[h,n("p",null,[f,n("a",g,[b,s(t)]),k]),w,n("p",null,[y,s(a,{to:"/Docs/rse_cli_command.html#system"},{default:o(()=>[_]),_:1}),v,I,S,x,E]),M,n("p",null,[q,n("a",A,[C,s(t)]),B]),P,n("p",null,[R,s(a,{to:"/Docs/zapp.html#a-zapp-file-example"},{default:o(()=>[z]),_:1}),L,O,T,Z,U,D,F]),j,n("p",null,[N,V,Y,s(a,{to:"/Docs/interact_zos_zowe_explorer.html#using-rse-api-in-zowe-explorer"},{default:o(()=>[J]),_:1}),W,G,H]),K,Q,X],64)}var oe=d(m,[["render",$]]);export{oe as default};
