{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "IBM ZCodeScan Rules Document",
  "description": "JSON schema for zcodescan-rules.yaml and zcodescan-rules.yaml files. Version 1.1.0 -- Licensed Materials - Property of IBM - (c) Copyright IBM Corporation 2022, 2025. All Rights Reserved.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "rules": {
      "description": "The list of rules to apply.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/ruleItem"
      },
      "minItems": 1
    }
  },
  "definitions": {
    "ruleItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "description": "The id of the rule to apply."
        },
        "severity": {
          "enum": ["BLOCKER", "HIGH", "MEDIUM", "LOW", "INFO", "OFF"]
        },
        "statements": {},
        "parameters": {
          "type": "array",
          "description": "Optional parameters for the rule.",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the parameter.",
                "minLength": 1
              },
              "value": {
                "description": "Parameter value.",
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "number"
                  },
                  {
                    "type": "boolean"
                  }
                ]
              }
            },
            "required": ["name", "value"],
            "additionalProperties": false
          },
          "minItems": 1
        }
      },
      "required": ["id"],
      "allOf": [
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.AcceptDateTimeRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.AcceptFromConsoleRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.AcceptRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.AlterRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.AvoidSectionInProcedureDivisionRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.BinarySubscriptRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.BlockContainsRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.BufferOverflowRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CallSyntaxRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CancelRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CheckSqlcodeAfterExecSqlRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.Comp3PictureClauseRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CompilerDirectivesRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.CompilerDirectivesRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ConditionNamePrefixRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.ConditionNamePrefixRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CopySuppressRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CopybookRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.CopybookRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.CorrespondingRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.DisplayUponConsoleRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.EntryRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.EvaluateNotIfRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.EvaluateWhenOtherRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ExitParagraphRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ExitProgramRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.FileNameConventionRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.FileNameConventionRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.FiveBasedLevelNumbersRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.GotoParagraphRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.GotoRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.IfElseRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.IndexSubscriptRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.InitializeRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.InlinePerformLineLimitRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.InlinePerformLineLimitRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.Level88Rule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.MultipleExitsRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.NestedIfLimitRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.NestedIfLimitRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.NextSentenceInScopedRangeRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.NextSentenceRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.OccursDependingOnRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ParagraphCommentRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.ParagraphCommentRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.PerformExceptPerformSectionRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.PerformWithThroughRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.PerformWithoutThroughRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ProcedureRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.ProcedureRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ProgramIdRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.RequireEndClauseRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.RequireEndClauseRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.ReserveRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.RespOptionRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.RestrictedRoutineRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.RestrictedRoutineRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SearchAllRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SectionCommentRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.SectionCommentRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SqlAvoidSelectStarRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SqlDeclareCursorOrderByRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SqlInjectionRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.SqlWhereRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.SqlWhereRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.StaticCallNameRule",
                "type": "string"
              }
            }
          },
          "then": {
            "properties": {
              "statements": {
                "description": "The list of statements for this rule.",
                "type": "array",
                "items": {
                  "$ref": "#/definitions/zcodescan.cobol.rules.StaticCallNameRuleStatementItem"
                },
                "minItems": 1
              }
            },
            "required": ["id", "statements"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.StopRunRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.UninitialzedVariablesRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.UnprotectedAuthCredentialRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        },
        {
          "if": {
            "properties": {
              "id": {
                "const": "zcodescan.cobol.rules.XMLParseRule",
                "type": "string"
              }
            }
          },
          "then": {
            "not": {
              "required": ["statements"]
            },
            "required": ["id"]
          }
        }
      ]
    },
    "zcodescan.cobol.rules.CompilerDirectivesRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": [
            "BasisDirective",
            "CopyDirective",
            "ProcessDirective",
            "ReplaceDirective",
            "ServicelabelDirective",
            "ServiceloadDirective",
            "TitleDirective"
          ]
        },
        "value": {
          "type": "boolean",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.ConditionNamePrefixRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["CONDITION_NAME_PREFIX"]
        },
        "value": {
          "type": "string",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.CopybookRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["CopybookName"]
        },
        "value": {
          "type": "string",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.FileNameConventionRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["ConventionMask"]
        },
        "value": {
          "type": "string",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.InlinePerformLineLimitRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["LineLimit"]
        },
        "value": {
          "type": "integer",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.NestedIfLimitRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["NestingLimit"]
        },
        "value": {
          "type": "integer",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.ParagraphCommentRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["LOCATION"]
        },
        "value": {
          "type": "integer",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.ProcedureRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["LineLimit"]
        },
        "value": {
          "type": "integer",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.RequireEndClauseRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["Call", "Evaluate", "If", "Read", "Search"]
        },
        "value": {
          "type": "boolean",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.RestrictedRoutineRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["RoutineName"]
        },
        "value": {
          "type": "string",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.SectionCommentRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["LOCATION"]
        },
        "value": {
          "type": "integer",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.SqlWhereRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["Delete", "Select", "Update"]
        },
        "value": {
          "type": "boolean",
          "description": "Perform statement"
        }
      }
    },
    "zcodescan.cobol.rules.StaticCallNameRuleStatementItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "enum": ["PROGRAM_NAME"]
        },
        "value": {
          "type": "string",
          "description": "Perform statement"
        }
      }
    }
  }
}
